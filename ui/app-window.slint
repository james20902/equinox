import {
    Button,
    VerticalBox,
    HorizontalBox,
    TextEdit,
    LineEdit,
    ComboBox,
} from "std-widgets.slint";

export component AppWindow inherits Window {
    title: "Equinox";

    out property <string> blog_title;
    out property <string> blog_content;
    in-out property <string> selected_project;
    in-out property <bool> show_create_index_prompt: false;
    in-out property <bool> show_selected_project: false;
    in property <[string]> categories: [];

    callback generate_page();
    callback parse_directory();
    callback create_index_file();
    callback cancel_create_index();
    callback category_selected(string);
    callback create_category();

    VerticalBox {
        Button {
            text: "Pick file";
            clicked => {
                root.parse_directory();
            }
        }

        Text {
            text: "Selected Project: " + selected_project;
            visible: show_selected_project;
        }

        HorizontalBox {
            visible: show_selected_project;
            Button {
                text: "Create category";
                clicked => {
                    root.create_category();
                }
            }

            if categories.length == 0: Text {
                text: "Create a category";
                vertical-alignment: center;
                color: #888888;
            }

            if categories.length > 0: ComboBox {
                model: categories;
                current-index: 0;
                selected(value) => {
                    root.category_selected(value);
                }
            }
        }

        HorizontalBox {
            Text {
                font-size: 18px;
                font-weight: 600;
                text: "Title";
            }

            LineEdit {
                font-size: 18px;
                width: 700px;
                height: 50px;
                edited(string) => {
                    blog_title = string
                };
            }
        }

        HorizontalBox {
            Text {
                font-size: 18px;
                font-weight: 600;
                text: "Content";
            }

            TextEdit {
                font-size: 14px;
                width: 700px;
                height: 500px;
                edited(text) => {
                    blog_content = text;
                }
            }
        }

        Button {
            text: "Generate";
            clicked => {
                root.generate_page();
            }
        }
    }

    // Prompt dialog for missing index.html
    if show_create_index_prompt: Rectangle {
        background: #00000080;

        Rectangle {
            width: 400px;
            height: 150px;
            background: black;
            border-radius: 8px;

            VerticalBox {
                padding: 20px;

                Text {
                    text: "No index.html found in this directory.";
                    font-size: 14px;
                    horizontal-alignment: center;
                }

                Text {
                    text: "Would you like to create one?";
                    font-size: 14px;
                    horizontal-alignment: center;
                }

                HorizontalBox {
                    alignment: center;
                    spacing: 10px;

                    Button {
                        text: "Create";
                        clicked => {
                            root.create_index_file();
                        }
                    }

                    Button {
                        text: "Cancel";
                        clicked => {
                            root.cancel_create_index();
                        }
                    }
                }
            }
        }
    }
}
